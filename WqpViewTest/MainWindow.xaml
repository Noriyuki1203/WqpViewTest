<Window x:Class="WqpViewTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WqpViewTest"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="1100">

    <!--<Window.Resources>
        -->
    <!-- 0/1 <-> bool -->
    <!--
        <local:IntToBoolConverter x:Key="IntToBoolConverter"/>

        -->
    <!-- 見出しを枠内に表示する GroupBox テンプレート（そのまま） -->
    <!--
        <Style x:Key="InnerHeaderGroupBox" TargetType="GroupBox">
            <Setter Property="BorderBrush" Value="#9AA0A6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GroupBox">
                        <Border BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <DockPanel LastChildFill="True">
                                <ContentPresenter ContentSource="Header"
                                                  DockPanel.Dock="Top"
                                                  Margin="0,0,0,8"
                                                  RecognizesAccessKey="True"/>
                                <ContentPresenter/>
                            </DockPanel>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>-->

    
    
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="3*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="1" Orientation="Horizontal">
            <!-- 左：Departments（そのまま） -->
            <!--<GroupBox Header="Departments" Margin="6" Width="250" Style="{StaticResource InnerHeaderGroupBox}">-->
            <GroupBox Header="Departments" Margin="6" Width="250" >
                <DataGrid x:Name="DepartmentsGrid"
                              AutoGenerateColumns="False"
                              IsReadOnly="False"
                              CanUserAddRows="False"
                              SelectionMode="Single"
                              SelectionUnit="FullRow"
                              RowHeaderWidth="0"
                              SelectionChanged="DepartmentsGrid_SelectionChanged"
                              PreviewMouseLeftButtonDown="DepartmentsGrid_PreviewMouseLeftButtonDown"
                              
                              FocusVisualStyle="{x:Null}"
                              Background="White">
                    <DataGrid.Resources>
                        <!-- 非アクティブ選択行（ウィンドウが非フォーカス時） -->
                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="Red"/>
                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>

                        <!-- アクティブ選択行（フォーカス中） -->
                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#1E90FF"/>
                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="White"/>
                    </DataGrid.Resources>

                    <!-- ▼ 行ごとのスタイル設定 -->
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <!-- 通常時 -->
                            <Setter Property="Background" Value="White"/>
                            <Setter Property="Foreground" Value="Black"/>

                            <!-- 状態に応じたトリガー -->
                            <Style.Triggers>
                                <!-- マウスホバー中 -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#E0F3FF"/>
                                    <Setter Property="Foreground" Value="Black"/>
                                </Trigger>

                                <!-- 選択中 -->
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#1E90FF"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>

                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="更新 (Refresh)" />
                            <Separator/>
                            <MenuItem Header="部署を追加…" />
                            <MenuItem Header="部署を削除"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="部署ID" Binding="{Binding [DepartmentId]}" SortMemberPath="DepartmentId"/>
                        <DataGridTextColumn Header="部署名" Binding="{Binding [DepartmentName]}" SortMemberPath="DepartmentName" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>

            </GroupBox>

            <!-- 右：Employees -->
            <GroupBox Header="Employees (選択部署のみ)" Margin="6" Width="450">
                <DataGrid x:Name="EmployeesGrid"
          AutoGenerateColumns="False"
          CanUserAddRows="False"
          RowHeaderWidth="0"                                   >
                    <!--CellEditEnding="EmployeesGrid_CellEditEnding">-->

          <DataGrid.Resources>
        <!-- 非アクティブ選択行（ウィンドウが非フォーカス時） -->
        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="Red"/>
        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="White"/>

        <!-- アクティブ選択行（フォーカス中） -->
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#1E90FF"/>
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="White"/>
    </DataGrid.Resources>

    <!-- ▼ 行ごとのスタイル設定 -->
    <DataGrid.RowStyle>
        <Style TargetType="DataGridRow">
            <!-- 通常時 -->
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>

            <!-- 状態に応じたトリガー -->
            <Style.Triggers>
                <!-- マウスホバー中 -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E0F3FF"/>
                    <Setter Property="Foreground" Value="Black"/>
                </Trigger>

                <!-- 選択中 -->
                <!--<Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#1E90FF"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>-->
            </Style.Triggers>
        </Style>
    </DataGrid.RowStyle>


                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID"
                        Binding="{Binding [EmployeeId]}"
                        SortMemberPath="EmployeeId"
                        IsReadOnly="True" Width="60"/>

                        <DataGridTextColumn Header="名前"
                        Binding="{Binding [Name]}"
                        SortMemberPath="Name"
                        Width="*"/>

                        <DataGridTextColumn Header="年齢"
                        Binding="{Binding [Age]}"
                        SortMemberPath="Age"
                        Width="60"/>

                        <DataGridTextColumn Header="部署ID"
                        Binding="{Binding [DepartmentId]}"
                        SortMemberPath="DepartmentId"
                        IsReadOnly="True" Width="80"/>

                        <DataGridCheckBoxColumn Header="有効"
                            Binding="{Binding [IsActive],
                                      Mode=TwoWay,
                                      UpdateSourceTrigger=PropertyChanged}"
                            SortMemberPath="IsActive"
                            Width="80"/>
                        <!--<DataGridCheckBoxColumn Header="有効"
     Binding="{Binding [IsActive],
               Mode=TwoWay,
               UpdateSourceTrigger=PropertyChanged,
               Converter={StaticResource IntToBoolConverter}}"
     SortMemberPath="IsActive"
     Width="80"/>-->
                    </DataGrid.Columns>
                </DataGrid>

            </GroupBox>

            <GroupBox Header="Details" Margin="6" Width="320">
                <DataGrid x:Name="DetailsGrid"
                          AutoGenerateColumns="True"
                          CanUserAddRows="False"
                          SelectionMode="Single"
                          SelectionUnit="FullRow"
                          RowHeaderWidth="0"/>
            </GroupBox>

        </StackPanel>
        <ProgressBar Width="100" Foreground="Green"/>
    </Grid>
</Window>
